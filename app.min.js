String.prototype.replaceAll=function(a,b){var c=this;return c.split(a).join(b)};var input=document.getElementById("file");input.addEventListener("change",function(a){document.getElementById("file-label").innerHTML=input.files[0].name;document.getElementById("file-button").style.display="inline-block"});$("#data").stickyTableHeaders();var app=angular.module("app",["ngSanitize"]);app.filter("percent",function(){return function(b){if(b){var a=b*100;return parseFloat(a.toFixed(2))+"%"}return b}});app.controller("controller",["$scope","$filter",function(a,b){a.floatTheadOptions={scrollingTop:10,useAbsolutePositioning:false};a.showResult=false;a.fileSelected="Välj fil";a.useColors=true;a.showMax=100;a.currFilter=new Array();a.showMoreResults=function(){a.showMax+=100;if(a.showMax>a.bodyDataFiltered.length){a.showMax=a.bodyDataFiltered.length}};a.addFilter=function(){a.currFilter.push(a.selectedFilter);a.filter()};a.removeFilter=function(c){var d=-1;for(i=0;i<a.currFilter.length;i++){if(a.currFilter[i].index==c){d=i;break}}if(d!=-1){a.currFilter.splice(d,1)}a.filter()};a.filter=function(){a.bodyDataFiltered=new Array();var d=new Array();for(i=0;i<a.currFilter.length;i++){if(a.currFilter[i].min||a.currFilter[i].max||a.currFilter[i].equal){d.push(a.currFilter[i])}}var c;var g;for(i=0;i<a.bodyData.length;i++){c=true;for(j=0;j<d.length;j++){g=a.bodyData[i][d[j].index];if(d[j].min){if(isNaN(g)||!(parseFloat(g)>=parseFloat(d[j].min))){c=false}}if(d[j].max){if(isNaN(g)||!(parseFloat(g)<=parseFloat(d[j].max))){c=false}}if(d[j].equal&&d[j].equal.length>0){var e=d[j].equal;e=e.trim();e=e.toLowerCase();if(g&&g.toLowerCase().indexOf(e)==-1){c=false}}}if(c){a.bodyDataFiltered.push(a.bodyData[i])}}a.showMax=100};a.getClass=function(c){if(a.useColors){if(!(c.match(/[a-z]/i))&&!isNaN(parseFloat(c))){if(c<0){return"red"}else{return"green"}}}};a.formatCell=function(c,e){var f=["Kursutveck","tillväxtÅr","Direktav","Utdelningsandel","Soliditet","ROC"];for(i=0;i<f.length;i++){if(c.name.indexOf(f[i])!=-1){return b("percent")(e)}}if(c.name.indexOf("Bolagsnamn")!=-1){var d=e.replaceAll(" ","-");d=d.replaceAll("Pref","preferensaktie");return'<a href="https://borsdata.se/'+d+'/nyckeltal" target="_blank">'+e+"</a>"}return e};a.buildFilter=function(){a.filterData=new Array();a.currFilter=new Array();for(i=0;i<a.headerData.length;i++){a.filterData.push({name:a.headerData[i]["name"],index:i,type:a.headerData[i]["type"]})}a.bodyDataFiltered=a.bodyData};a.determineCellType=function(c,d){if(c){if((c.match(/[a-z]/i))||isNaN(parseFloat(c))){a.headerData[d]["type"]="s"}else{a.headerData[d]["type"]="f"}}};a.getFile=function(){var d=document.getElementById("file");var c=new FileReader();if(d.files[0]){var e=d.files[0];var f=a;c.onload=function(h){var g=h.target.result;f.$apply(function(){a.showResult=true;a.headerData=new Array();a.bodyData=new Array();var m=g.split(/\r\n|\n/);var s=m[0];var r=m[1];var p=s.split(";");var o=r.split(";");var n;for(i=0;i<p.length;i++){n=p[i].replaceAll('"',"")+o[i].replaceAll('"',"");n=n.replace("Info","");n=n.trim();a.headerData.push({name:n,type:null})}var l;for(i=2;i<m.length;i++){l=m[i].split(";");row=[];for(k=0;k<l.length;k++){var q=l[k].replaceAll('"',"");row[k]=q;a.determineCellType(q,k)}a.bodyData.push(row)}a.buildFilter()})};c.readAsText(e,"ISO-8859-1")}}}]);